openapi: 3.1.0
info:
  title: Заявки на сканирование уязвимостей
  description: API для заявок на сканирование уязвимостей
  version: '1.0'
  contact:
    name: Ульев Андрей Дмитриевич
    email: Andrey.Ulev@innostage-group.ru
servers:
  - url: 'http://127.0.0.1/api'
    description: test
  - url: 'http://10.70.41.64/api'
    description: dev
paths:
  '/enquiry-scanning-vulnerabilities/{id}':
    parameters:
      - schema:
          type: integer
        name: id
        in: path
        required: true
        description: Id заявки на сканирование уязвимостей
    get:
      operationId: showEnquiryScanningVulnerabilities
      summary: showEnquiryScanningVulnerabilities
      tags:
        - enquiry-scanning-vulnerabilities
      description: Получение заявки на сканирование уязвимостей по Id
      responses:
        '200':
          description: Заявка найдена
          content:
            application/json:
              schema:
                $ref: ../models/enquiry-scanning-vulnerability.yaml
              examples:
                Example 1:
                  value:
                    id: 1
                    status: Сканирование завершено
                    initiator:
                      id: 0
                      name: string
                      last_name: string
                      second_name: string
                      phone: string
                      email: string
                    created_at: '22.01.2021 11:39:10'
                    information_system: Наименование информационной системы
                    ip_addresses:
                      - 192.168.0.1
                    balancer_ip_addresses:
                      - 192.168.0.1
                    domains:
                      - example.com
                    scanning_redcheck_started_at: 22.01.2021
                    scanning_redcheck_ended_at: 24.01.2021
                    scanner: Redcheck
                    scanning_redcheck_period: Однократно
                    proof:
                      - name: avatar.png
                        url: upload/iblock/8d1/cb0j2yhe0afsi77vflncl9y22zqcfyg9.jpg
                    comments:
                      - id: 1
                        author:
                          id: 0
                          name: string
                          last_name: string
                          second_name: string
                          phone: string
                          email: string
                        text: Пример текста комментария
                        created_at: '24.01.2021 11:39:10'
                    job_id: 1
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-401.yaml
              examples: null
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-404.yaml
              examples: null
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-500.yaml
              examples: null
    delete:
      operationId: destroyEnquiryScanningVulnerabilities
      summary: destroyEnquiryScanningVulnerabilities
      tags:
        - enquiry-scanning-vulnerabilities
      description: Удаление заявки на сканирование уязвимостей по Id
      responses:
        '200':
          description: Заявка найдена
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-200.yaml
              examples:
                Example 1:
                  value:
                    message: Успешно
                    code: 200
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-401.yaml
              examples: null
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-404.yaml
              examples: null
        '404':
          description: Not found
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-404.yaml
              examples: null
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-500.yaml
              examples: null
  /enquiry-scanning-vulnerabilities:
    get:
      operationId: indexEnquiryScanningVulnerabilities
      summary: indexEnquiryScanningVulnerabilities
      tags:
        - enquiry-scanning-vulnerabilities
      description: Получение списка заявок на сканирование уязвимостей
      parameters:
        - schema:
            type: string
          in: query
          name: search
          description: Поисковая строка
        - schema:
            type: integer
            minimum: 10
          in: query
          name: per_page
          description: Кол-во элементов на странице
        - schema:
            type: integer
            minimum: 1
          in: query
          name: page
          description: Номер страницы
        - schema:
            type: string
            example: REDCHECK_SCANNING_ERROR
            enum:
              - REDCHECK_DRAFT
              - REDCHECK_ON_APPROVAL
              - REDCHECK_ON_ADJUSTMENT
              - REDCHECK_REJECTED
              - REDCHECK_AGREED
              - REDCHECK_ERROR_SENDING
              - REDCHECK_SCANNING
              - REDCHECK_SCANNING_COMPLETED
              - REDCHECK_SCANNING_ERROR
          in: query
          name: status
          description: Статус
        - schema:
            type: string
            format: date
            pattern: '^\d{4}-\d{2}-\d{2}$'
            example: '2023-01-01'
          in: query
          name: created_at_from
          description: Дата создания - начало периода
        - schema:
            type: string
            format: date
            pattern: '^\d{4}-\d{2}-\d{2}$'
            example: '2023-01-02'
          in: query
          name: created_at_to
          description: Дата создания - конец периода
        - schema:
            type: string
            enum:
              - id
              - status
            example: id
          in: query
          name: sort_field
          description: Колонка для сортировки
        - schema:
            type: string
            enum:
              - asc
              - desc
            default: asc
          in: query
          name: sort_order
          description: Направление сортировки
      responses:
        '200':
          description: Список заявок
          content:
            application/json:
              schema:
                allOf:
                  - properties:
                      data:
                        type: array
                        items:
                          $ref: ../models/enquiry-scanning-vulnerability.yaml
                  - $ref: ../models/components/pagination.yaml
                type: object
              examples:
                Example 1:
                  value:
                    data:
                      - id: 1
                        status: Сканирование завершено
                        initiator:
                          id: 0
                          name: string
                          last_name: string
                          second_name: string
                          phone: string
                          email: string
                        created_at: '22.01.2021 11:39:10'
                        information_system: Наименование информационной системы
                        ip_addresses:
                          - 192.168.0.1
                        balancer_ip_addresses:
                          - 192.168.0.1
                        domains:
                          - example.com
                        scanning_redcheck_started_at: 22.01.2021
                        scanning_redcheck_ended_at: 24.01.2021
                        scanner: Redcheck
                        scanning_redcheck_period: Однократно
                        proof:
                          - name: avatar.png
                            url: upload/iblock/8d1/cb0j2yhe0afsi77vflncl9y22zqcfyg9.jpg
                        comments:
                          - id: 1
                            author:
                              id: 0
                              name: string
                              last_name: string
                              second_name: string
                              phone: string
                              email: string
                            text: Пример текста комментария
                            created_at: '24.01.2021 11:39:10'
                        job_id: 1
                    current_page: 0
                    last_page: 0
                    per_page: 0
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-401.yaml
              examples: null
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-422.yaml
              examples: null
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-500.yaml
              examples: null
    post:
      summary: createEnquiryScanningVulnerabilities
      operationId: createEnquiryScanningVulnerabilities
      tags:
        - enquiry-scanning-vulnerabilities
      description: Создание заявки на сканирование уязвимостей
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                information_system:
                  type: string
                  description: Наименование информационной системы
                  example: test
                ip_addresses:
                  type: array
                  items:
                    type: string
                    format: ipv4
                  description: IP адреса
                  example:
                    - 127.0.0.1
                    - 127.0.0.2
                    - 127.0.0.3
                balancer_ip_addresses:
                  type: array
                  items:
                    type: string
                    format: ipv4
                  description: IP адреса балансировщиков
                  example:
                    - 127.0.0.1
                    - 127.0.0.2
                    - 127.0.0.3
                domains:
                  type: array
                  items:
                    type: string
                    format: hostname
                  description: Доменные имена
                  example:
                    - example.com
                    - example2.com
                    - example3.com
                scanner:
                  type: string
                  description: Сканер
                  enum:
                    - REDCHECK
                scanning_redcheck_started_at:
                  type: string
                  format: date
                  description: Дата начала сканирования в RedCheck
                  example: '2023-10-11'
                scanning_redcheck_ended_at:
                  type: string
                  format: date
                  description: Дата завершения сканирования в RedCheck
                  example: '2023-10-29'
                scanning_redcheck_period:
                  type: string
                  enum:
                    - ONCE
                    - WEEKLY
                    - MONTHLY
                  description: Периодичность сканирования
                  example: ONCE
                proof:
                  type: array
                  items:
                    type: string
                    format: binary
                  description: Подтверждение принадлежности адресов
      responses:
        '200':
          description: Заявка создана
          content:
            application/json:
              schema:
                $ref: ../models/enquiry-scanning-vulnerability.yaml
              examples:
                Example 1:
                  value:
                    id: 1
                    status: Черновик
                    initiator:
                      id: 0
                      name: string
                      last_name: string
                      second_name: string
                      phone: string
                      email: string
                    created_at: '22.01.2021 11:39:10'
                    information_system: Наименование информационной системы
                    ip_addresses:
                      - 192.168.0.1
                    balancer_ip_addresses:
                      - 192.168.0.1
                    domains:
                      - example.com
                    scanning_redcheck_started_at: 22.01.2021
                    scanning_redcheck_ended_at: 24.01.2021
                    scanner: Redcheck
                    scanning_redcheck_period: Ежемесячно
                    proof:
                      - name: avatar.png
                        url: upload/iblock/8d1/cb0j2yhe0afsi77vflncl9y22zqcfyg9.jpg
                    comments:
                      - id: 1
                        author:
                          id: 0
                          name: string
                          last_name: string
                          second_name: string
                          phone: string
                          email: string
                        text: Пример текста комментария
                        created_at: '24.01.2021 11:39:10'
                    job_id: 1
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-401.yaml
              examples: null
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-422.yaml
              examples: null
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-500.yaml
              examples: null
  /enquiry-scanning-vulnerabilities/draft:
    post:
      summary: createDraftEnquiryScanningVulnerabilities
      operationId: createDraftEnquiryScanningVulnerabilities
      tags:
        - enquiry-scanning-vulnerabilities
      description: Создание черновика заявки на сканирование уязвимостей
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                information_system:
                  type: string
                  description: Наименование информационной системы
                  example: test
                ip_addresses:
                  type: array
                  items:
                    type: string
                    format: ipv4
                  description: IP адреса
                  example:
                    - 127.0.0.1
                    - 127.0.0.2
                    - 127.0.0.3
                balancer_ip_addresses:
                  type: array
                  items:
                    type: string
                    format: ipv4
                  description: IP адреса балансировщиков
                  example:
                    - 127.0.0.1
                    - 127.0.0.2
                    - 127.0.0.3
                domains:
                  type: array
                  items:
                    type: string
                    format: hostname
                  description: Доменные имена
                  example:
                    - example.com
                    - example2.com
                    - example3.com
                scanner:
                  type: string
                  description: Сканер
                  enum:
                    - REDCHECK
                scanning_redcheck_started_at:
                  type: string
                  format: date
                  description: Дата начала сканирования в RedCheck
                  example: '2023-10-11'
                scanning_redcheck_ended_at:
                  type: string
                  format: date
                  description: Дата завершения сканирования в RedCheck
                  example: '2023-10-29'
                scanning_redcheck_period:
                  type: string
                  enum:
                    - ONCE
                    - WEEKLY
                    - MONTHLY
                  description: Периодичность сканирования
                  example: ONCE
                proof:
                  type: array
                  items:
                    type: string
                    format: binary
                  description: Подтверждение принадлежности адресов
      responses:
        '200':
          description: Черновик заявки создан
          content:
            application/json:
              schema:
                $ref: ../models/enquiry-scanning-vulnerability.yaml
              examples:
                Example 1:
                  value:
                    id: 1
                    status: Сканирование завершено
                    initiator:
                      id: 0
                      name: string
                      last_name: string
                      second_name: string
                      phone: string
                      email: string
                    created_at: '22.01.2021 11:39:10'
                    information_system: Наименование информационной системы
                    ip_addresses:
                      - 192.168.0.1
                    balancer_ip_addresses:
                      - 192.168.0.1
                    domains:
                      - example.com
                    scanning_redcheck_started_at: 22.01.2021
                    scanning_redcheck_ended_at: 24.01.2021
                    scanner: Redcheck
                    scanning_redcheck_period: Однократно
                    proof:
                      - name: avatar.png
                        url: upload/iblock/8d1/cb0j2yhe0afsi77vflncl9y22zqcfyg9.jpg
                    comments:
                      - id: 1
                        author:
                          id: 0
                          name: string
                          last_name: string
                          second_name: string
                          phone: string
                          email: string
                        text: Пример текста комментария
                        created_at: '24.01.2021 11:39:10'
                    job_id: 1
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-401.yaml
              examples: null
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-422.yaml
              examples: null
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-500.yaml
              examples: null
  '/enquiry-scanning-vulnerabilities/{id}/approval':
    parameters:
      - schema:
          type: integer
        name: id
        in: path
        required: true
        description: Id заявки на сканирование уязвимостей
    post:
      summary: updateApprovalEnquiryScanningVulnerabilities
      operationId: updateApprovalEnquiryScanningVulnerabilities
      tags:
        - enquiry-scanning-vulnerabilities
      description: Редактирование заявки на сканирование уязвимостей участником ВЦ
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                information_system:
                  type: string
                  description: Наименование информационной системы
                  example: test
                ip_addresses:
                  type: array
                  items:
                    type: string
                    format: ipv4
                  description: IP адреса
                  example:
                    - 127.0.0.1
                    - 127.0.0.2
                    - 127.0.0.3
                balancer_ip_addresses:
                  type: array
                  items:
                    type: string
                    format: ipv4
                  description: IP адреса балансировщиков
                  example:
                    - 127.0.0.1
                    - 127.0.0.2
                    - 127.0.0.3
                domains:
                  type: array
                  items:
                    type: string
                    format: hostname
                  description: Доменные имена
                  example:
                    - example.com
                    - example2.com
                    - example3.com
                scanner:
                  type: string
                  description: Сканер
                  enum:
                    - REDCHECK
                scanning_redcheck_started_at:
                  type: string
                  format: date
                  description: Дата начала сканирования в RedCheck
                  example: '2023-10-11'
                scanning_redcheck_ended_at:
                  type: string
                  format: date
                  description: Дата завершения сканирования в RedCheck
                  example: '2023-10-29'
                scanning_redcheck_period:
                  type: string
                  enum:
                    - ONCE
                    - WEEKLY
                    - MONTHLY
                  description: Периодичность сканирования
                  example: ONCE
                proof:
                  type: array
                  items:
                    type: string
                    format: binary
                  description: Подтверждение принадлежности адресов
      responses:
        '200':
          description: Заявка обновлена
          content:
            application/json:
              schema:
                $ref: ../models/enquiry-scanning-vulnerability.yaml
              examples:
                Example 1:
                  value:
                    id: 1
                    status: Сканирование завершено
                    initiator:
                      id: 0
                      name: string
                      last_name: string
                      second_name: string
                      phone: string
                      email: string
                    created_at: '22.01.2021 11:39:10'
                    information_system: Наименование информационной системы
                    ip_addresses:
                      - 192.168.0.1
                    balancer_ip_addresses:
                      - 192.168.0.1
                    domains:
                      - example.com
                    scanning_redcheck_started_at: 22.01.2021
                    scanning_redcheck_ended_at: 24.01.2021
                    scanner: Redcheck
                    scanning_redcheck_period: Однократно
                    proof:
                      - name: avatar.png
                        url: upload/iblock/8d1/cb0j2yhe0afsi77vflncl9y22zqcfyg9.jpg
                    comments:
                      - id: 1
                        author:
                          id: 0
                          name: string
                          last_name: string
                          second_name: string
                          phone: string
                          email: string
                        text: Пример текста комментария
                        created_at: '24.01.2021 11:39:10'
                    job_id: 1
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-401.yaml
              examples: null
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-404.yaml
              examples: null
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-422.yaml
              examples: null
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-500.yaml
              examples: null
  '/enquiry-scanning-vulnerabilities/{id}/wc-worker':
    parameters:
      - schema:
          type: integer
        name: id
        in: path
        required: true
        description: Id заявки на сканирование уязвимостей
    post:
      summary: updateWcWorkerEnquiryScanningVulnerabilities
      operationId: updateWcWorkerEnquiryScanningVulnerabilities
      tags:
        - enquiry-scanning-vulnerabilities
      description: Редактирование заявки на сканирование уязвимостей сотрудником ВЦ
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                information_system:
                  type: string
                  description: Наименование информационной системы
                  example: test
                ip_addresses:
                  type: array
                  items:
                    type: string
                    format: ipv4
                  description: IP адреса
                  example:
                    - 127.0.0.1
                    - 127.0.0.2
                    - 127.0.0.3
                balancer_ip_addresses:
                  type: array
                  items:
                    type: string
                    format: ipv4
                  description: IP адреса балансировщиков
                  example:
                    - 127.0.0.1
                    - 127.0.0.2
                    - 127.0.0.3
                domains:
                  type: array
                  items:
                    type: string
                    format: hostname
                  description: Доменные имена
                  example:
                    - example.com
                    - example2.com
                    - example3.com
                scanner:
                  type: string
                  description: Сканер
                  enum:
                    - REDCHECK
                scanning_redcheck_started_at:
                  type: string
                  format: date
                  description: Дата начала сканирования в RedCheck
                  example: '2023-10-11'
                scanning_redcheck_ended_at:
                  type: string
                  format: date
                  description: Дата завершения сканирования в RedCheck
                  example: '2023-10-29'
                scanning_redcheck_period:
                  type: string
                  enum:
                    - ONCE
                    - WEEKLY
                    - MONTHLY
                  description: Периодичность сканирования
                  example: ONCE
                proof:
                  type: array
                  items:
                    type: string
                    format: binary
                  description: Подтверждение принадлежности адресов
      responses:
        '200':
          description: Заявка обновлена
          content:
            application/json:
              schema:
                $ref: ../models/enquiry-scanning-vulnerability.yaml
              examples:
                Example 1:
                  value:
                    id: 1
                    status: Сканирование завершено
                    initiator:
                      id: 0
                      name: string
                      last_name: string
                      second_name: string
                      phone: string
                      email: string
                    created_at: '22.01.2021 11:39:10'
                    information_system: Наименование информационной системы
                    ip_addresses:
                      - 192.168.0.1
                    balancer_ip_addresses:
                      - 192.168.0.1
                    domains:
                      - example.com
                    scanning_redcheck_started_at: 22.01.2021
                    scanning_redcheck_ended_at: 24.01.2021
                    scanner: Redcheck
                    scanning_redcheck_period: Однократно
                    proof:
                      - name: avatar.png
                        url: upload/iblock/8d1/cb0j2yhe0afsi77vflncl9y22zqcfyg9.jpg
                    comments:
                      - id: 1
                        author:
                          id: 0
                          name: string
                          last_name: string
                          second_name: string
                          phone: string
                          email: string
                        text: Пример текста комментария
                        created_at: '24.01.2021 11:39:10'
                    job_id: 1
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-401.yaml
              examples: null
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-404.yaml
              examples: null
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-422.yaml
              examples: null
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-500.yaml
              examples: null
  '/enquiry-scanning-vulnerabilities/{id}/draft':
    parameters:
      - schema:
          type: integer
        name: id
        in: path
        required: true
        description: Id заявки на сканирование уязвимостей
    post:
      summary: updateDraftEnquiryScanningVulnerabilities
      operationId: updateDraftEnquiryScanningVulnerabilities
      tags:
        - enquiry-scanning-vulnerabilities
      description: Редактирование черновика заявки на сканирование уязвимостей
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                information_system:
                  type: string
                  description: Наименование информационной системы
                  example: test
                ip_addresses:
                  type: array
                  items:
                    type: string
                    format: ipv4
                  description: IP адреса
                  example:
                    - 127.0.0.1
                    - 127.0.0.2
                    - 127.0.0.3
                balancer_ip_addresses:
                  type: array
                  items:
                    type: string
                    format: ipv4
                  description: IP адреса балансировщиков
                  example:
                    - 127.0.0.1
                    - 127.0.0.2
                    - 127.0.0.3
                domains:
                  type: array
                  items:
                    type: string
                    format: hostname
                  description: Доменные имена
                  example:
                    - example.com
                    - example2.com
                    - example3.com
                scanner:
                  type: string
                  description: Сканер
                  enum:
                    - REDCHECK
                scanning_redcheck_started_at:
                  type: string
                  format: date
                  description: Дата начала сканирования в RedCheck
                  example: '2023-10-11'
                scanning_redcheck_ended_at:
                  type: string
                  format: date
                  description: Дата завершения сканирования в RedCheck
                  example: '2023-10-29'
                scanning_redcheck_period:
                  type: string
                  enum:
                    - ONCE
                    - WEEKLY
                    - MONTHLY
                  description: Периодичность сканирования
                  example: ONCE
                proof:
                  type: array
                  items:
                    type: string
                    format: binary
                  description: Подтверждение принадлежности адресов
      responses:
        '200':
          description: Заявка обновлена
          content:
            application/json:
              schema:
                $ref: ../models/enquiry-scanning-vulnerability.yaml
              examples:
                Example 1:
                  value:
                    id: 1
                    status: Сканирование завершено
                    initiator:
                      id: 0
                      name: string
                      last_name: string
                      second_name: string
                      phone: string
                      email: string
                    created_at: '22.01.2021 11:39:10'
                    information_system: Наименование информационной системы
                    ip_addresses:
                      - 192.168.0.1
                    balancer_ip_addresses:
                      - 192.168.0.1
                    domains:
                      - example.com
                    scanning_redcheck_started_at: 22.01.2021
                    scanning_redcheck_ended_at: 24.01.2021
                    scanner: Redcheck
                    scanning_redcheck_period: Однократно
                    proof:
                      - name: avatar.png
                        url: upload/iblock/8d1/cb0j2yhe0afsi77vflncl9y22zqcfyg9.jpg
                    comments:
                      - id: 1
                        author:
                          id: 0
                          name: string
                          last_name: string
                          second_name: string
                          phone: string
                          email: string
                        text: Пример текста комментария
                        created_at: '24.01.2021 11:39:10'
                    job_id: 1
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-401.yaml
              examples: null
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-404.yaml
              examples: null
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-422.yaml
              examples: null
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-500.yaml
              examples: null
  '/enquiry-scanning-vulnerabilities/{id}/moderate':
    parameters:
      - schema:
          type: integer
        name: id
        in: path
        required: true
        description: Id заявки на сканирование уязвимостей
    patch:
      summary: moderateEnquiryScanningVulnerabilities
      operationId: moderateEnquiryScanningVulnerabilities
      tags:
        - enquiry-scanning-vulnerabilities
      description: Согласование заявки на сканирование уязвимостей
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                comment:
                  type: string
                  description: Комментарий
                  example: Все хорошо или не очень
                status:
                  type: string
                  enum:
                    - AGREED
                    - ON_ADJUSTMENT
                    - REJECTED
                  description: Статус модерации
                  example: REJECTED
            examples:
              Example 1:
                value:
                  comment: Все хорошо или не очень
                  status: AGREED
      responses:
        '200':
          description: Заявка промодерирована
          content:
            application/json:
              schema:
                $ref: ../models/enquiry-scanning-vulnerability.yaml
              examples: null
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-401.yaml
              examples: null
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-404.yaml
              examples: null
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-422.yaml
              examples: null
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-500.yaml
              examples: null
  '/enquiry-scanning-vulnerabilities/{id}/close':
    parameters:
      - schema:
          type: integer
        name: id
        in: path
        required: true
        description: Id заявки на сканирование уязвимостей
    patch:
      summary: closeEnquiryScanningVulnerabilities
      operationId: closeEnquiryScanningVulnerabilities
      tags:
        - enquiry-scanning-vulnerabilities
      description: Завершение сканирования вручную
      responses:
        '200':
          description: Заявка завершена
          content:
            application/json:
              schema:
                $ref: ../models/enquiry-scanning-vulnerability.yaml
              examples:
                Example 1:
                  value:
                    id: 1
                    status: Сканирование завершено
                    initiator:
                      id: 0
                      name: string
                      last_name: string
                      second_name: string
                      phone: string
                      email: string
                    created_at: '22.01.2021 11:39:10'
                    information_system: Наименование информационной системы
                    ip_addresses:
                      - 192.168.0.1
                    balancer_ip_addresses:
                      - 192.168.0.1
                    domains:
                      - example.com
                    scanning_redcheck_started_at: 22.01.2021
                    scanning_redcheck_ended_at: 24.01.2021
                    scanner: Redcheck
                    scanning_redcheck_period: Однократно
                    proof:
                      - name: avatar.png
                        url: upload/iblock/8d1/cb0j2yhe0afsi77vflncl9y22zqcfyg9.jpg
                    comments:
                      - id: 1
                        author:
                          id: 0
                          name: string
                          last_name: string
                          second_name: string
                          phone: string
                          email: string
                        text: Пример текста комментария
                        created_at: '24.01.2021 11:39:10'
                    job_id: 1
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-401.yaml
              examples: null
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-404.yaml
              examples: null
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-422.yaml
              examples: null
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: ../models/errors/error-500.yaml
              examples: null
